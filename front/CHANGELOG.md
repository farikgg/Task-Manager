# Журнал изменений

Все значимые изменения в этом проекте будут документированы в этом файле.

## [1.1.0] - 2025-04-29

### Добавлено
- Функциональность JWT Refresh Tokens
- Механизм обновления токенов в axios interceptors
- Автоматическое обновление токенов при 401 ошибках
- Безопасное хранение access и refresh токенов

### Изменено
- Обновлен процесс аутентификации для работы с access и refresh токенами
- Изменен процесс входа для хранения обоих токенов
- Улучшена обработка ошибок, связанных с токенами
- Обновлена конфигурация axios для поддержки обновления токенов

### Безопасность
- Реализован безопасный механизм обновления токенов
- Добавлено автоматическое обновление токенов при истечении срока
- Улучшена безопасность с помощью правильного хранения токенов
- Добавлена корректная обработка ошибок при обновлении токенов

### Технические детали
- Обновлен `auth.js`:
  - Добавлена функция refreshToken
  - Изменен процесс входа для хранения обоих токенов
  - Обновлен процесс выхода для очистки обоих токенов
  - Добавлена обработка ошибок при обновлении токенов

- Обновлен `axiosConfig.js`:
  - Добавлен interceptor для обновления токенов
  - Реализован механизм повторных попыток для неудачных запросов
  - Добавлена корректная обработка 401 ответов
  - Включена поддержка credentials для cross-origin запросов

### Критические изменения
- Изменено хранение токенов с одного на пару access/refresh токенов
- Обновлен формат заголовка аутентификации
- Изменена обработка ответов API для операций с токенами

### Руководство по миграции
Для миграции на новую версию:
1. Обновите обработку входа для работы с accessToken и refreshToken
2. Обновите хранение токенов для работы с обоими токенами
3. Убедитесь, что ваш backend API поддерживает эндпоинт обновления токенов
4. Обновите любую пользовательскую логику аутентификации для работы с новой системой токенов

## [1.3.0] - 2025-05-05

### Добавлено
- Поддержка Docker для фронтенд-приложения
- Конфигурация Nginx для раздачи React-приложения
- Многоэтапная сборка Docker для оптимизированного production-образа
- Конфигурация Docker Compose для полноценной разработки
- Настройка проксирования API в Nginx

### Изменено
- Обновлен процесс сборки для использования Docker
- Изменена конфигурация URL API для Docker-окружения
- Улучшен рабочий процесс разработки с использованием контейнеризированных сервисов

### Технические детали
- Добавлен `Dockerfile`:
  - Многоэтапный процесс сборки
  - Этап сборки на Node.js
  - Этап production на Nginx
  - Оптимизирован для production-использования

- Добавлен `nginx.conf`:
  - Раздача статических файлов
  - Проксирование запросов к API
  - Поддержка SPA-роутинга
  - Обработка страниц ошибок

- Добавлен `docker-compose.yml`:
  - Конфигурация фронтенд-сервиса
  - Интеграция с API-сервисом
  - Настройка MongoDB-сервиса
  - Управление переменными окружения
  - Зависимости между сервисами

### Настройка разработки
Для запуска полного стека с Docker:

1. Собрать и запустить все сервисы:
   ```bash
   docker-compose up --build
   ```

2. Доступ к приложению:
   - Фронтенд: http://localhost
   - API: http://localhost:5001
   - MongoDB: mongodb://localhost:27017

### Развертывание в production
Для развертывания в production:

1. Собрать образ фронтенда:
   ```bash
   docker build -t todo-frontend .
   ```

2. Запустить контейнер:
   ```bash
   docker run -p 80:80 todo-frontend
   ```

### Примечания по безопасности
- Nginx настроен для безопасной раздачи статических файлов
- Запросы к API правильно проксируются
- Переменные окружения управляются безопасно
- Production-сборка оптимизирована для производительности

## [1.3.1] - 2025-05-10
- Добавлен переключатель между режимами "Календарь" и "Список" (View Toggle):
  - Пример: `<ViewToggle view={view} setView={setView} />`
- Добавлен минималистичный компонент переключателя (UI Component)
- Подключены контексты темы и уведомлений (ThemeContext, NotificationContext):
  - Пример: `useTheme()`, `useNotification()`
- Добавлен компонент профиля пользователя (UserProfile UI):
  - Пример: `<UserProfile />`
- Улучшен базовый стиль и структура главной страницы (Minimalistic UI)
- Подготовлена интеграция с API профиля пользователя (User Profile API)


## [1.4.0] - 2025-05-15
### Добавлено
- Интеграция Google OAuth на фронтенде:
  - Добавлена кнопка "Войти через Google" на странице входа
  - Реализована обработка Google OAuth callback
  - Добавлена поддержка автоматического входа после Google аутентификации
  - Интеграция с новыми эндпоинтами бэкенда для Google OAuth

### Изменено
- Обновлен компонент Login для поддержки Google аутентификации
- Улучшен процесс аутентификации для поддержки как локальной, так и Google аутентификации
- Обновлены стили для поддержки новой кнопки Google

### UI/UX
- Добавлена кнопка Google с фирменным стилем
- Улучшен внешний вид страницы входа
- Добавлены анимации для кнопки Google
- Улучшена обратная связь при процессе аутентификации

### Технические детали
- Обновлен auth.js для поддержки Google OAuth
- Добавлена обработка Google токенов в axios interceptors
- Улучшена обработка ошибок для Google аутентификации

## [1.4.1] - 2025-05-24

### Добавлено
- Улучшен календарь: теперь задачи в ячейке дня отображаются по одной, остальные доступны через модальное окно.
- Добавлен модальный просмотр всех задач дня с возможностью добавления, редактирования и удаления задач.
- В выпадающемся списке категорий при создании задачи теперь отображаются только актуальные категории.
- В профиле пользователя реализован выбор цвета для новой категории с помощью выпадающего списка с цветными кружками (react-select).
- После добавления новой категории она сразу появляется в выпадающем списке при создании задач.
- Улучшен UX управления задачей: кнопки "выполнено", "редактировать" и "удалить" вынесены отдельно, используются современные иконки.

### Исправлено
- Исправлена обработка категорий: теперь категории — это объекты, а не строки.
- Исправлены ошибки отображения категорий и задач при обновлении страницы.
- Исправлены стили и логика выбора цвета для категорий.

## [1.4.2] - 2025-05-24

### Исправления и улучшения

- Реализовано более безопасное управление токенами: refresh токен теперь хранится только в HTTP-only cookie, убрано хранение в localStorage.
- Добавлен перехватчик axios для автоматического обновления access токена при истечении его срока действия (при получении 401 ошибки).
- Обновлена функция выхода из системы для взаимодействия с бэкендом и очистки refresh токена из cookie и базы данных. 